(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24ae7575"],{"13f7":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-list article"},[n("div",{staticClass:"mt-list-filter"},[n("el-form",{ref:"form",attrs:{model:t.filter,"label-width":"80px"}},[n("el-row",[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"文章标题"}},[n("mt-input",{attrs:{width:t.inputWidth},model:{value:t.filter.title,callback:function(e){t.$set(t.filter,"title",e)},expression:"filter.title"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"文章状态"}},[n("mt-select",{attrs:{options:t.statusOptions,width:t.inputWidth},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("div",{staticClass:"mt-list-filter-btn"},[n("mt-button",{on:{click:t.addBtn}},[t._v("新建")]),t._v(" "),n("mt-button",{on:{click:t.readList}},[t._v("搜索")]),t._v(" "),n("mt-button",{attrs:{type:"submain"},on:{click:t.resetSearch}},[t._v("重置")])],1)])],1)],1)],1),t._v(" "),n("el-table",{staticClass:"mt-list-table table",attrs:{data:t.list,height:"auto"}},[n("el-table-column",{attrs:{prop:"title",label:"文章标题","min-width":"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"status",label:"文章状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-switch",{attrs:{activeText:"上架",inactiveText:"下架"},on:{change:function(n){return t.changeStatus(n,e.row)}},model:{value:e.row.status,callback:function(n){t.$set(e.row,"status",n)},expression:"scope.row.status"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","min-width":"140"}}),t._v(" "),n("el-table-column",{attrs:{prop:"createBy",label:"创建人","min-width":"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"140"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("mt-button",{attrs:{type:"table"},on:{click:function(n){return t.goEdit(e.row)}}},[t._v("编辑")]),t._v(" "),n("mt-button",{attrs:{type:"table"},on:{click:function(n){return t.goDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),n("div",{staticClass:"mt-list-footer"},[n("div",{staticClass:"totaldata"},[t._v("共"+t._s(t.total)+"条")]),t._v(" "),n("div",{staticClass:"page"},[n("el-pagination",{staticClass:"mt-page",staticStyle:{float:"right"},attrs:{"current-page":t.page,"page-size":t.pageSize,"page-sizes":t.pageSizes,total:t.total,background:"",layout:t.pageLayout},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),n("create-dialog",{ref:"createDialog",on:{update:t.readList}})],1)},a=[],s=(n("ac6a"),n("96cf"),n("1da1")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"article-dialog",attrs:{title:t.title,visible:t.dialogVisible,width:"60%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"文章标题"}},[n("mt-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"缩略图"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.API.UPLOAD_FILE,name:"files",data:t.uploadData,"show-file-list":!1,"on-success":t.handleThumb}},[t.form.thumbnail?n("img",{staticClass:"avatar",attrs:{src:t.form.thumbnail}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),n("el-form-item",{attrs:{label:"文章内容"}},[n("editor",{model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("mt-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")]),t._v(" "),n("mt-button",{on:{click:t.handleClose}},[t._v("取消")])],1)],1)},r=[],l=n("892c"),c=n("ed08"),u={name:"",data:function(){return{form:{code:"",title:"",thumbnail:"",content:"",files:[]},dialogType:"add",dialogVisible:!1}},computed:{title:function(){return"add"===this.dialogType?"新建文章":"编辑文章"},uploadData:function(){return{accountId:this.$store.state.user.userInfo.accountInfo.accountId,token:this.$store.state.user.token}}},components:{Editor:l["a"]},created:function(){},mounted:function(){},methods:{open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"edit"===t&&(this.form=this._.assign(e),this.form.files=e["file_paths"]),this.dialogType=t,this.dialogVisible=!0},handleThumb:function(t,e){1e4===t.code&&(this.form.thumbnail=Object(c["e"])(t.data.file_paths[0]))},handleSubmit:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.submitForm()}))},submitForm:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this._.clone(this.form),"add"===this.dialogType?(delete e.code,this.$request.post(this.API.ADD_ARTICLE,e).then((function(t){t.success&&(n.$mtMessage.success("新建成功!"),n.$emit("update"),n.handleClose())}))):"edit"===this.dialogType&&this.$request.post(this.API.UPDATE_ARTICLE,e).then((function(t){t.success&&(n.$mtMessage.success("编辑成功!"),n.$emit("update"),n.handleClose())}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleClose:function(){this.dialogVisible=!1,Object(c["d"])(this.form)}}},d=u,f=(n("d51a"),n("f8b6"),n("2877")),h=Object(f["a"])(d,o,r,!1,null,"cb01a0b8",null),p=h.exports,m=n("839d"),g={name:"ArticleList",components:{createDialog:p},data:function(){return{filter:{title:"",status:""},statusOptions:[],inputWidth:"calc(100% - 1rem)"}},mixins:[m["a"]],created:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.DICT.getDict("DICTYPZhyLQ2dzUoFSMAE81708568288");case 2:this.statusOptions=t.sent,this.readList();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),mounted:function(){},methods:{readList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this._.clone(this.filter),e.page=this.page,e.pageSize=this.pageSize,this.$request.post(this.API.GET_ARTICLE_LIST,e).then((function(t){console.log("getArticleList:",t),t.success&&(t.data.records.forEach((function(t){t.status=1===t.status})),n.list=t.data.records,n.total=t.data.total)}));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addBtn:function(){this.$refs.createDialog.open("add")},goEdit:function(t){t.status?this.$mtMessage.warning("请先下架文章后再编辑!"):this.$refs.createDialog.open("edit",this._.clone(t))},goDelete:function(t){var e=this;this.$confirm("是否删除该文章？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deleteArticle(t)})).catch((function(){}))},deleteArticle:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n={code:e.code},this.$request.post(this.API.DELETE_ARTICLE,n).then((function(t){t.success&&(i.$mtMessage.success("删除成功！"),i.readList())}));case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeStatus:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var i,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={code:n.code,status:e?1:0},t.next=3,this.$request.post(this.API.CHANGE_ARTICLE_STATUS,i).then((function(t){t.success&&(a.$mtMessage({message:"修改成功",type:"success"}),a.readList())}));case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}},v=g,b=(n("273d"),n("f0f6"),Object(f["a"])(v,i,a,!1,null,"5853a066",null));e["default"]=b.exports},"273d":function(t,e,n){"use strict";n("ebad")},3234:function(t,e,n){},"839d":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n("20d6"),n("7514"),n("c5f6"),n("ac6a"),n("28a5"),n("a481");var i=n("ed08"),a=(document.querySelector("body").offsetHeight,{data:function(){return{list:[],listKey:"",listRowStyle:{cursor:"pointer"},tableHeight:"auto",tableHeightFixed:"20rem",inputWidth:"calc(100% - 40px)",selected:[],total:0,page:1,pageSize:20,pageSizes:[20,50,100,200],pageLayout:"sizes, prev, pager, next",activeRow:0,fixedBottom:!1}},mounted:function(){var t=this;window.onresize=function(){t.fixedBottom=document.documentElement.clientHeight<window.screen.height};var e=document.querySelector(".app-main");e.onscroll=function(){e.scrollTop+document.body.clientHeight>=e.scrollHeight?t.fixedBottom=!1:t.fixedBottom=!0}},watch:{list:{deep:!0,handler:function(){1===this.page||this.list.length||(this.page--,this.readList())}}},computed:{totalSelected:function(){return this.selected.length},listBtnDisabled:function(){return!this.totalSelected},isStripe:function(){return this.$store.state.settings.isStripe}},filters:{formatMoney:function(t){for(var e=2,n=parseFloat((t+"").replace(/[^\d\.-]/g,"")).toFixed(e)+"",i=n.split(".")[0].split("").reverse(),a=n.split(".")[1],s="",o=0;o<i.length;o++)s+=i[o]+((o+1)%3==0&&o+1!=i.length?",":"");return"￥"+s.split("").reverse().join("")+"."+a},formatDate:function(t){var e=t.split("、"),n="";return e.forEach((function(t){var e=t.split("-"),i=Number(e[1])>9?e[1]:"0"+e[1],a=Number(e[2])>9?e[2]:"0"+e[2];n+=e[0]+"年"+i+"月"+a+"日、"})),n.substring(0,n.length-1)}},methods:{readList:function(){},resetSearch:function(){Object(i["d"])(this.filter),this.page=1,this.pageSize=20,this.readList()},emptyFormatter:function(t,e){return e.property&&(t[e.property]||0===t[e.property])?t[e.property]:"--"},adSearch:function(){this.page=1,this.readList()},autoSelectList:function(){var t=this,e=this.listKey,n=this.$refs.tableList;n&&this.list.forEach((function(i,a){var s=t.selected.find((function(t){return t[e]===i[e]}));s&&setTimeout((function(){n.toggleRowSelection(t.list[a],!0)}),50)}))},tableRowClassName:function(t){var e=t.row;t.rowIndex;if(e===this.activeRow)return"active-row"},handleSelect:function(t,e){var n=this.listKey,i=!!t.find((function(t){return t[n]===e[n]})),a=this.selected.findIndex((function(t){return console.log(t,e),t[n]===e[n]}));i&&-1===a&&this.selected.push(e),i||-1===a||this.selected.splice(a,1)},handleSelectAll:function(t){var e=this,n=this.listKey;t.length?t.forEach((function(t){var i=e.selected.find((function(e){return e[n]===t[n]}));i||e.selected.push(t)})):this.list.forEach((function(t){var i=e.selected.findIndex((function(e){return e[n]===t[n]}));-1!==i&&e.selected.splice(i,1)}))},handleSelectedChange:function(t){},handleSizeChange:function(t){this.pageSize=t,this.page=1,this.readList()},handleCurrentChange:function(t){this.page=t,this.readList()}}})},"892c":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"quill-editor"},[n("quill-editor",{ref:"QuillEditor",attrs:{content:t.content,options:t.editorOption},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),n("upload-image",{ref:"uploadImage",on:{success:t.uploadImage}})],1)},a=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-upload",{staticClass:"upload-demo",attrs:{action:t.actionUrl,name:"files",data:t.uploadData,"show-file-list":!1,"on-success":t.handleChange}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"input",attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)},o=[],r={name:"ComponentUploadImage",data:function(){return{}},computed:{actionUrl:function(){return this.API.UPLOAD_FILE},uploadData:function(){return{accountId:this.$store.state.user.userInfo.accountInfo.accountId,token:this.$store.state.user.token}}},created:function(){},mounted:function(){},methods:{handleChange:function(t){1e4===t.code&&this.$emit("success",t.data.file_paths[0])}}},l=r,c=n("2877"),u=Object(c["a"])(l,s,o,!1,null,"cf098434",null),d=u.exports,f=n("953d"),h=(n("a753"),n("8096"),n("14e1"),[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small","large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}],["clean"],["link","image"]]),p={name:"QuillEditor",props:{value:{type:String,default:""},needVideo:{type:Boolean,default:!0}},data:function(){var t=this;return{content:this.value,editorOption:{placeholder:"请输入...",theme:"snow",modules:{history:{delay:1e3,maxStack:50,userOnly:!1},toolbar:{container:h,handlers:{lineheight:function(e){if(e){var n=t.$refs.myQuillEditor.quill;n.format("lineHeight",e)}},image:function(e){t.$refs.uploadImage.$refs.input.$el.click()}}}}}}},components:{quillEditor:f["quillEditor"],UploadImage:d},watch:{value:function(t){this.content=t},content:function(){this.$emit("input",this.content)}},created:function(){},mounted:function(){},methods:{uploadImage:function(t){var e=this.$refs.QuillEditor.quill,n=e.getSelection().index;e.insertEmbed(n,"image",t),e.setSelection(n+1)}}},m=p,g=Object(c["a"])(m,i,a,!1,null,"fefe9852",null);e["a"]=g.exports},a21e:function(t,e,n){t.exports={menuText:"rgba(25,28,34,0.8)",menuActiveText:"#4D9BD5",subMenuActiveText:"#4D9BD5",menuBg:"#fff",menuHover:"rgba(77,155,213,0.2)",subMenuBg:"#F4F5F9",subMenuHover:"rgba(77,155,213,0.2)",sideBarWidth:"240px",activeBg:"rgba(77,155,213,0.1)",hoverBg:"rgba(25,28,34,0.05)"}},cf9f:function(t,e,n){t.exports={menuText:"rgba(25,28,34,0.8)",menuActiveText:"#4D9BD5",subMenuActiveText:"#4D9BD5",menuBg:"#fff",menuHover:"rgba(77,155,213,0.2)",subMenuBg:"#F4F5F9",subMenuHover:"rgba(77,155,213,0.2)",sideBarWidth:"240px",activeBg:"rgba(77,155,213,0.1)",hoverBg:"rgba(25,28,34,0.05)"}},d51a:function(t,e,n){"use strict";n("3234")},ebad:function(t,e,n){},f0f6:function(t,e,n){"use strict";n("a21e")},f8b6:function(t,e,n){"use strict";n("cf9f")}}]);