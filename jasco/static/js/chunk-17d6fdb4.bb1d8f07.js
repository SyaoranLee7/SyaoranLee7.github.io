(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17d6fdb4"],{"0369":function(t,e,i){"use strict";i("2bfb2")},"2bfb2":function(t,e,i){},"470e":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"appeal-detail"},[i("div",{staticClass:"head"},[i("div",{staticClass:"info head-info"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("诉求标题")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(t.detail.title))])])])],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("诉求企业")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(t.detail.companyName))])])]),t._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("诉求用户")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(t.detail.userName))])])])],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:8}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("处理状态")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(t.detail.statusName))])])]),t._v(" "),i("el-col",{attrs:{span:8}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("当前处理人")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(t.detail.dealBy.join("、")))])])]),t._v(" "),i("el-col",{attrs:{span:8}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("手机号码")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(t.detail.phone))])])])],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:8}},[i("div",{staticClass:"info-item info-appraise"},[i("div",{staticClass:"info-item-title"},[t._v("评价")]),t._v(" "),1===t.detail.appraise?i("el-tag",{staticClass:"appraise"},[t._v("满意")]):0===t.detail.appraise?i("el-tag",{staticClass:"appraise",attrs:{type:"success"}},[t._v("很满意")]):2===t.detail.appraise?i("el-tag",{staticClass:"appraise",attrs:{type:"info"}},[t._v("一般")]):3===t.detail.appraise?i("el-tag",{staticClass:"appraise",attrs:{type:"warning"}},[t._v("不满意")]):4===t.detail.appraise?i("el-tag",{staticClass:"appraise",attrs:{type:"danger"}},[t._v("很不满意")]):t._e()],1)])],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:4}},[i("div",{staticClass:"info-btn btn1",on:{click:t.goDeal}},[t._v("处理")])]),t._v(" "),t.showBtn?i("el-col",{attrs:{span:4}},[i("el-popover",{attrs:{placement:"right",width:"200",trigger:"click"}},[i("el-table",{attrs:{data:t.toOptions},on:{"row-click":t.selectTo}},[i("el-table-column",{attrs:{width:"200",property:"label",label:"部门名称"}})],1),t._v(" "),i("div",{staticClass:"info-btn btn2",attrs:{slot:"reference"},slot:"reference"},[t._v("转给")])],1)],1):t._e()],1)],1)]),t._v(" "),i("div",{staticClass:"content"},[i("el-timeline",t._l(t.detail.records,(function(e){return i("el-timeline-item",{key:e.id,attrs:{timestamp:e.time,placement:"top"}},[i("el-card",["appeal"===e.type?i("div",{staticClass:"info"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("诉求内容")]),t._v(" "),i("div",{staticClass:"info-item-body appeal-container"},[i("div",{staticClass:"appeal-container-text"},[t._v(t._s(e.content))]),t._v(" "),i("div",{staticClass:"appeal-container-file"},[t._l(e.files,(function(e,s){return"image"===t.isImage(e)?i("el-image",{key:s,staticClass:"img",attrs:{src:e,"preview-src-list":[e]}}):t._e()})),t._v(" "),t._l(e.files,(function(e,s){return"video"===t.isImage(e)?i("video",{key:s,staticClass:"video",attrs:{width:"80",height:"80",controls:""}},[i("source",{attrs:{src:e}})]):t._e()}))],2)])])]),t._v(" "),i("el-col",{attrs:{span:24}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("诉求时间")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(e.createTime))])])])],1)],1):"reply"===e.type?i("div",{staticClass:"info"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("处理结果")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(e.content))])])]),t._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("处理人")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(e.dealBy))])])]),t._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-item-title"},[t._v("处理时间")]),t._v(" "),i("div",{staticClass:"info-item-body"},[t._v(t._s(e.createTime))])])])],1)],1):t._e()])],1)})),1)],1),t._v(" "),i("deal-dialog",{ref:"dealDialog",attrs:{id:t.id},on:{update:t.getDetail}})],1)},a=[],n=(i("6762"),i("28a5"),i("a481"),i("ac6a"),i("c5f6"),i("96cf"),i("1da1")),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"处理诉求",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("mt-input",{attrs:{type:"textarea"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("mt-button",{on:{click:t.dealBtn}},[t._v("确定")]),t._v(" "),i("mt-button",{attrs:{type:"submain"},on:{click:t.handleClose}},[t._v("取消")])],1)],1)},o=[],r={name:"DealDialog",props:{id:{type:Number,default:0}},data:function(){return{text:"",dialogVisible:!1}},created:function(){},mounted:function(){},methods:{open:function(){this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1,this.text=""},dealBtn:function(){var t=this;if(this.text){var e={id:this.id,content:this.text};this.$request.post(this.API.REPLY_APPEAL,e).then((function(e){e.success&&(t.$mtMessage.success("处理成功!"),t.$emit("update"),t.handleClose())}))}else this.$mtMessage.error("请填写处理回复!")}}},c=r,d=i("2877"),u=Object(d["a"])(c,l,o,!1,null,"1e3aa75e",null),f=u.exports,p=i("839d"),v=(i("ed08"),{name:"AppealDetail",components:{DealDialog:f},data:function(){return{id:this.$route.query.id,detail:{title:"",companyName:"",userName:"",status:"",statusName:"",dealBy:[],dealByName:"",phone:"",appraise:0,appraiseName:"",records:[]},jf:"",toOptions:[],inputWidth:"calc(100% - 1rem)"}},computed:{showBtn:function(){var t=this.$store.state.user.userInfo;return t.accountInfo.accountId===this.jf.value}},mixins:[p["a"]],created:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.id=Number(this.$route.query.id),this.id&&this.getDetail(),t.next=4,this.DICT.getDict("DICTYP2btNhgyWC3j8Qq5n1708308955");case 4:return this.jf=t.sent[0],t.next=7,this.DICT.getDict("DICTYPtxNKJhobV9BfrZdM1708308947");case 7:this.toOptions=t.sent;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),mounted:function(){},methods:{getDetail:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e={id:this.id},this.$request.post(this.API.GET_APPEAL_DETAIL,e).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.success&&(e.data.statusName=i.DICT.getDictLabel("DICTYP7lJQZbAeCWNKwiFB1708241396",e.data.status),e.data.appraiseName=i.DICT.getDictLabel("DICTYPtp8fE6a1wBT5MLF21708399082",e.data.appraise),s=e.data.dealBy.map((function(t){return t===i.jf.value?i.DICT.getDictLabel("DICTYP2btNhgyWC3j8Qq5n1708308955",t):i.DICT.getDictLabel("DICTYPtxNKJhobV9BfrZdM1708308947",t)})),e.data.dealByName=s.join("、"),e.data.records.forEach((function(t){t.id||(t.id=i._.uniqueId()),"reply"===t.type&&t.dealBy&&(t.dealBy===i.jf.value?t.dealBy=i.jf.label:t.dealBy=i.DICT.getDictLabel("DICTYPtxNKJhobV9BfrZdM1708308947",t.dealBy)||t.dealBy);var e=[];t.files&&t.files.forEach((function(t){e.push(t.replace("bqztc-obs","bqztc-cmzd.cn/obs"))})),t.files=e})),i.detail=i._.assign(e.data));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),goDeal:function(){this.$refs.dealDialog.open()},selectTo:function(t){var e=this;this.$confirm("确定要将该诉求转给"+t.label+"吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.handleTo(t)})).catch((function(){}))},handleTo:function(t){var e=this,i={id:this.id,to:t.value};this.$request.post(this.API.TRANSFER_APPEAL,i).then((function(t){t.success&&e.$mtMessage.success("转移成功!")}))},isImage:function(t){var e=["jpg","jpeg","png"],i=["mp4","avi"],s=t.split(".").pop().toLowerCase();return e.includes(s)?"image":!!i.includes(s)&&"video"}}}),h=v,m=(i("0369"),Object(d["a"])(h,s,a,!1,null,"d637f808",null));e["default"]=m.exports},6762:function(t,e,i){"use strict";var s=i("5ca1"),a=i("c366")(!0);s(s.P,"Array",{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("includes")},"839d":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i("20d6"),i("7514"),i("c5f6"),i("ac6a"),i("28a5"),i("a481");var s=i("ed08"),a=(document.querySelector("body").offsetHeight,{data:function(){return{list:[],listKey:"",listRowStyle:{cursor:"pointer"},tableHeight:"auto",tableHeightFixed:"20rem",inputWidth:"calc(100% - 40px)",selected:[],total:0,page:1,pageSize:20,pageSizes:[20,50,100,200],pageLayout:"sizes, prev, pager, next",activeRow:0,fixedBottom:!1}},mounted:function(){var t=this;window.onresize=function(){t.fixedBottom=document.documentElement.clientHeight<window.screen.height};var e=document.querySelector(".app-main");e.onscroll=function(){e.scrollTop+document.body.clientHeight>=e.scrollHeight?t.fixedBottom=!1:t.fixedBottom=!0}},watch:{list:{deep:!0,handler:function(){1===this.page||this.list.length||(this.page--,this.readList())}}},computed:{totalSelected:function(){return this.selected.length},listBtnDisabled:function(){return!this.totalSelected},isStripe:function(){return this.$store.state.settings.isStripe}},filters:{formatMoney:function(t){for(var e=2,i=parseFloat((t+"").replace(/[^\d\.-]/g,"")).toFixed(e)+"",s=i.split(".")[0].split("").reverse(),a=i.split(".")[1],n="",l=0;l<s.length;l++)n+=s[l]+((l+1)%3==0&&l+1!=s.length?",":"");return"￥"+n.split("").reverse().join("")+"."+a},formatDate:function(t){var e=t.split("、"),i="";return e.forEach((function(t){var e=t.split("-"),s=Number(e[1])>9?e[1]:"0"+e[1],a=Number(e[2])>9?e[2]:"0"+e[2];i+=e[0]+"年"+s+"月"+a+"日、"})),i.substring(0,i.length-1)}},methods:{readList:function(){},resetSearch:function(){Object(s["d"])(this.filter),this.page=1,this.pageSize=20,this.readList()},emptyFormatter:function(t,e){return e.property&&(t[e.property]||0===t[e.property])?t[e.property]:"--"},adSearch:function(){this.page=1,this.readList()},autoSelectList:function(){var t=this,e=this.listKey,i=this.$refs.tableList;i&&this.list.forEach((function(s,a){var n=t.selected.find((function(t){return t[e]===s[e]}));n&&setTimeout((function(){i.toggleRowSelection(t.list[a],!0)}),50)}))},tableRowClassName:function(t){var e=t.row;t.rowIndex;if(e===this.activeRow)return"active-row"},handleSelect:function(t,e){var i=this.listKey,s=!!t.find((function(t){return t[i]===e[i]})),a=this.selected.findIndex((function(t){return console.log(t,e),t[i]===e[i]}));s&&-1===a&&this.selected.push(e),s||-1===a||this.selected.splice(a,1)},handleSelectAll:function(t){var e=this,i=this.listKey;t.length?t.forEach((function(t){var s=e.selected.find((function(e){return e[i]===t[i]}));s||e.selected.push(t)})):this.list.forEach((function(t){var s=e.selected.findIndex((function(e){return e[i]===t[i]}));-1!==s&&e.selected.splice(s,1)}))},handleSelectedChange:function(t){},handleSizeChange:function(t){this.pageSize=t,this.page=1,this.readList()},handleCurrentChange:function(t){this.page=t,this.readList()}}})}}]);